// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © vishwas_saikumar
//@version=6
indicator("Custom SMA", overlay=true)

// Input: Lookback period for the moving average
l = input(14, title="Time")

// User input for source data (close, open, high, low, hl2, etc.)
Option = input.string("close", title="P", options=["close", "open", "high", "low"])

// Map the selected price source to the actual data
P = switch Option
    "close" => close
    "open" => open
    "high" => high
    "low" => low

// Custom function to calculate smooth moving average using customizable price source
movingAverage(l,P) =>
    float s = 0.0
    for i = 0 to l - 1
        s := s + P[i]
    s / l

// Call the custom function and plot the result
customSma = movingAverage(l,P)
plot(customSma, color=color.blue, linewidth=2, title="Custom Smooth MA (Custom Source)")

// Built-in SMA using customizable price source
builtInSma = ta.sma(P, l)
plot(builtInSma, color=color.green, linewidth=2, title="Built-in SMA (Custom Source)")

// Compare both SMAs and plot a marker if they match
plotshape(series=customSma == builtInSma and not na(customSma) and not na(builtInSma), location=location.abovebar, color=color.red, style=shape.triangleup, title="SMA Match")
